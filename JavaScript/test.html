<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>旋转</title>
</head>
<style>
    .wrapper {
        width: 600px;
        height: 600px;
        background: #F8F8F8;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .z {
        display: inline-block;
        height: 40px;
        width: 40px;
        text-align: center;
        background: #8e5151;
        color: #FFF;
        border-radius: 100%;
        margin: 6px;
        border: 2px solid #666;
        border-bottom-color: transparent;
        vertical-align: middle;
        -webkit-animation: rotate 0.75s linear infinite;
        animation: rotate 0.75s linear infinite;
    }

    @-webkit-keyframes rotate {
        0% {
            -webkit-transform: rotate(0deg);
        }

        50% {
            -webkit-transform: rotate(180deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
        }
    }

    @keyframes rotate {
        0% {
            transform: rotate(0deg);
        }

        50% {
            transform: rotate(180deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }
</style>

<body>
    <div class="wrapper">
        <div class="z">
            zou
        </div>
    </div>
</body>

<script>
    // // 1. 创建一个 xhr 对象
    // var xhr = new XMLHttpRequest();
    // // 2. 设置请求的方式和路径
    // xhr.open('GET', 'file:///Users/cheese/github/basics/JavaScript/test2.html');
    // // 3. 发送请求
    // xhr.send(null);
    // // 4. 注册事件
    // xhr.onload = function () {
    //     // 通过 xhr 的 responseText 获取到响应的响应体
    //     console.log(this.responseText)
    // }


    var xhr = new XMLHttpRequest()
    xhr.open('POST', 'file:///Users/cheese/github/basics/JavaScript/test2.html')
    // 设置 Content-Type 为 application/x-www-form-urlencoded，这行代码不用死记硬背，去复制即可
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')
    // 需要提交到服务端的数据可以通过 send 方法的参数传递
    // 格式：name=zhangsan&age=18
    xhr.send('name=zhangsan&age=18')
    xhr.onload = function () {
        console.log(this.responseText)
    }


    var xhr = new XMLHttpRequest()
    xhr.open('GET', 'URL');
    xhr.setRequestHeader('Content-Type', 'application/x')
    xhr.send('name=111&age=2')
    xhr.onreadystatechange = function () {
        if (this.readyState === 4) {

        }
    }





    function axios({
        url,
        method = 'GET',
        params = {},
        data = {}
    }) {
        // 返回一个promise对象
        return new Promise((resolve, reject) => {

            // 处理method(转大写)
            method = method.toUpperCase()

            // 处理query参数(拼接到url上)   id=1&xxx=abc
            /* 
            {
              id: 1,ß
              xxx: 'abc'
            }
            */
            let queryString = ''
            Object.keys(params).forEach(key => {
                queryString += `${key}=${params[key]}&`
            })
            if (queryString) { // id=1&xxx=abc&
                // 去除最后的&
                queryString = queryString.substring(0, queryString.length - 1)
                // 接到url
                url += '?' + queryString
            }


            // 1. 执行异步ajax请求
            // 创建xhr对象
            const request = new XMLHttpRequest()
            // 打开连接(初始化请求, 没有请求)
            request.open(method, url, true)

            // 发送请求
            if (method === 'GET' || method === 'DELETE') {
                request.send()
            } else if (method === 'POST' || method === 'PUT') {
                request.setRequestHeader('Content-Type', 'application/json;charset=utf-8') // 告诉服务器请求体的格式是json
                request.send(JSON.stringify(data)) // 发送json格式请求体参数
            }

            // 绑定状态改变的监听
            request.onreadystatechange = function () {
                // 如果请求没有完成, 直接结束
                if (request.readyState !== 4) {
                    return
                }
                // 如果响应状态码在[200, 300)之间代表成功, 否则失败
                const { status, statusText } = request
                // 2.1. 如果请求成功了, 调用resolve()
                if (status >= 200 && status <= 299) {
                    // 准备结果数据对象response
                    const response = {
                        data: JSON.parse(request.response),
                        status,
                        statusText
                    }
                    resolve(response)
                } else { // 2.2. 如果请求失败了, 调用reject()
                    reject(new Error('request error status is ' + status))
                }
            }
        })
    }

</script>